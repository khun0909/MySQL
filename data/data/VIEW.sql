SELECT * 
FROM (SELECT * FROM tCity) A;

SELECT * 
FROM (SELECT * FROM tStaff WHERE grade = '과장' OR grade = '부장') A 
WHERE A.score >= 70;

CREATE TABLE DEPT_COPY
AS
SELECT * FROM DEPT;

CREATE TABLE EMP_COPY
AS
SELECT * FROM EMP;

SELECT EMPNO, ENAME, DEPTNO
FROM EMP_COPY
WHERE DEPTNO=30;

CREATE VIEW EMP_VIEW30
AS 
SELECT EMPNO, ENAME, DEPTNO
FROM EMP_COPY
WHERE DEPTNO=30;

SELECT * 
FROM EMP_VIEW30; 

DESC EMP_VIEW30;

INSERT INTO EMP_VIEW30
VALUES(8000, 'ANGEL', 30);

SELECT * 
FROM EMP_VIEW30;

SELECT * 
FROM EMP_COPY;

CREATE OR REPLACE
VIEW EMP_VIEW(사원번호, 사원명, 급여, 부서번호)
AS 
SELECT EMPNO, ENAME, SAL, DEPTNO 
FROM EMP_COPY;

SELECT * FROM EMP_VIEW
WHERE 부서번호=30;

CREATE VIEW VIEW_SAL
AS
SELECT DEPTNO, SUM(SAL) AS "SalSum", AVG(SAL) AS "SalAvg"
FROM EMP_COPY
GROUP BY DEPTNO;

SELECT E.EMPNO, E.ENAME, E.SAL, E.DEPTNO, D.DNAME, D.LOC 
FROM EMP E, DEPT D
WHERE E.DEPTNO = D.DEPTNO
ORDER BY EMPNO DESC;

CREATE VIEW EMP_VIEW_DEPT
AS
SELECT E.EMPNO, E.ENAME, E.SAL, E.DEPTNO, D.DNAME, D.LOC 
FROM EMP E, DEPT D
WHERE E.DEPTNO = D.DEPTNO
ORDER BY EMPNO DESC;

SELECT * 
FROM EMP_VIEW_DEPT;

DROP VIEW VIEW_SAL;

CREATE OR REPLACE VIEW EMP_VIEW30
AS 
SELECT EMPNO, ENAME, SAL, COMM, DEPTNO 
FROM EMP_COPY
WHERE DEPTNO=30;


CREATE OR REPLACE VIEW EMP_VIEW30
AS 
SELECT EMPNO, ENAME, DEPTNO, SAL
FROM EMP_COPY
WHERE DEPTNO=30;

SELECT * 
FROM EMP_VIEW30;

UPDATE EMP_VIEW30 
SET DEPTNO=20
WHERE SAL >= 1200; 

CREATE OR REPLACE VIEW VIEW_CHK30
AS 
SELECT EMPNO, ENAME, DEPTNO, SAL
FROM EMP_COPY
WHERE DEPTNO=30
WITH CHECK OPTION;

SELECT * 
FROM VIEW_CHK30;

UPDATE VIEW_CHK30 
SET SAL = 1200 
WHERE DEPTNO = 20;

SELECT * 
FROM EMP_COPY;

WITH TEMP AS
(SELECT NAME, SALARY, SCORE FROM tStaff WHERE DEPART = '영업부' AND GENDER = '남') 

SELECT * FROM TEMP WHERE SALARY >= (SELECT AVG(SALARY) FROM TEMP);

WITH TEMP(이름, 월급, 성취도) AS
(SELECT NAME, SALARY, SCORE FROM tStaff WHERE DEPART = '영업부' AND GENDER = '남') 

SELECT * FROM TEMP WHERE 월급 >= (SELECT AVG(월급) FROM TEMP);

WITH MAN AS
(SELECT NAME, SALARY, SCORE FROM tStaff WHERE DEPART = '영업부' AND GENDER = '남'), 
WOMAN AS
(SELECT NAME, SALARY, SCORE FROM tStaff WHERE DEPART = '영업부' AND GENDER = '여') 
SELECT * FROM WOMAN WHERE SALARY >= (SELECT avg(SALARY) FROM MAN);

WITH MAN AS
(SELECT NAME, SALARY, SCORE FROM tStaff WHERE DEPART = '영업부' AND GENDER = '남'),  
GOODMAN AS
(SELECT NAME, SALARY, SCORE FROM MAN WHERE SCORE > 70)
SELECT * 
FROM GOODMAN;
