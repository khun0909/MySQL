SELECT DEPTNO			
FROM DEPT				 
	UNION				    
SELECT DEPTNO			    
FROM EMP;

SELECT DEPTNO			
FROM DEPT				 
	UNION	ALL			    
SELECT DEPTNO			    
FROM EMP;

SELECT DEPTNO
FROM DEPT
INTERSECT
SELECT DEPTNO
FROM EMP;

SELECT DEPTNO
FROM DEPT
EXCEPT
SELECT DEPTNO
FROM EMP;


SELECT MAX(POPU), NAME 
FROM tCity; 

SELECT NAME 
FROM tCity 
WHERE POPU = MAX(POPU);

SELECT MAX(POPU) 
FROM tCity;

SELECT NAME FROM tCity 
WHERE POPU = 974;

SELECT NAME 
FROM tCity 
WHERE POPU = (SELECT MAX(POPU) FROM tCity);

SELECT ENAME, SAL
FROM EMP
WHERE SAL > ( SELECT AVG(SAL)
              FROM EMP); 

SELECT * 
FROM tStaff 
WHERE DEPART = (SELECT DEPART FROM tStaff WHERE NAME = '안중근')
       AND GENDER = (SELECT GENDER FROM tStaff WHERE NAME = '안중근');
      
SELECT * 
FROM tStaff 
WHERE (DEPART, GENDER) = (SELECT DEPART, GENDER FROM tStaff WHERE NAME = '안중근');

SELECT EMPNO, ENAME, SAL, DEPTNO
FROM EMP
WHERE SAL = (SELECT MAX(SAL)
		FROM EMP
		GROUP BY DEPTNO);
	
SELECT EMPNO, ENAME, SAL, DEPTNO
FROM EMP
WHERE SAL IN (SELECT MAX(SAL)
				FROM EMP
				GROUP BY DEPTNO);
			
SELECT ENAME, SAL, DEPTNO 
FROM EMP
WHERE DEPTNO IN ( SELECT DISTINCT DEPTNO
			FROM EMP 
			WHERE SAL>=3000);
		
SELECT ENAME, SAL
FROM EMP
WHERE SAL > ALL(SELECT SAL
             FROM EMP
             WHERE DEPTNO =30);
            
SELECT ENAME, SAL
FROM EMP
WHERE SAL > (SELECT MAX(SAL)
             FROM EMP
             WHERE DEPTNO =30);
            
SELECT ENAME, SAL
FROM EMP
WHERE SAL > ANY ( SELECT SAL 
                  FROM EMP 
                  WHERE DEPTNO = 30 );

SELECT ENAME, SAL
FROM EMP
WHERE SAL > ( SELECT MIN(SAL) 
                  FROM EMP 
                  WHERE DEPTNO = 30 );

SELECT ENAME, SAL
FROM EMP
WHERE EXISTS (SELECT 1 FROM EMP WHERE SAL > 2000);

SELECT * 
FROM tStaff 
WHERE (DEPART, SALARY) IN (SELECT DEPART, MAX(SALARY) FROM tStaff GROUP BY DEPART);


CREATE TABLE TCAR
(
	car VARCHAR(30) NOT NULL,		-- 이름
	capacity INT NOT NULL,		-- 배기량
	price INT NOT NULL,			-- 가격
	maker VARCHAR(30) NOT NULL		-- 제조사
);

INSERT INTO TCAR (car, capacity, price, maker) VALUES ('소나타', 2000, 2500, '현대');
INSERT INTO TCAR (car, capacity, price, maker) VALUES ('티볼리', 1600, 2300, '쌍용');
INSERT INTO TCAR (car, capacity, price, maker) VALUES ('A8', 3000, 4800, 'Audi');
INSERT INTO TCAR (car, capacity, price, maker) VALUES ('SM5', 2000, 2600, '삼성');


CREATE TABLE TMAKER
(
	maker VARCHAR(30) NOT NULL,		-- 회사
	factory CHAR(10) NOT NULL,	    	-- 공장
	domestic CHAR(1) NOT NULL		-- 국산 여부. Y/N
);

INSERT INTO TMAKER (maker, factory, domestic) VALUES ('현대', '부산', 'y');
INSERT INTO TMAKER (maker, factory, domestic) VALUES ('쌍용', '청주', 'y');
INSERT INTO TMAKER (maker, factory, domestic) VALUES ('Audi', '독일', 'n');
INSERT INTO TMAKER (maker, factory, domestic) VALUES ('기아', '서울', 'y');

SELECT *
FROM EMP, DEPT;

SELECT *
FROM EMP, DEPT
WHERE EMP.DEPTNO = DEPT.DEPTNO;

SELECT ENAME, DNAME
FROM EMP, DEPT
WHERE EMP.DEPTNO=DEPT.DEPTNO
AND ENAME='MILLER';

SELECT ENAME, DNAME, DEPTNO
FROM EMP, DEPT 
WHERE EMP.DEPTNO = DEPT.DEPTNO
AND ENAME='MILLER';

SELECT EMP.ENAME, DEPT.DNAME, EMP.DEPTNO
FROM EMP, DEPT
WHERE EMP.DEPTNO=DEPT.DEPTNO
AND ENAME='MILLER';

SELECT E.ENAME, D.DNAME, E.DEPTNO, D.DEPTNO
FROM EMP E, DEPT D
WHERE E.DEPTNO = D.DEPTNO
AND E.ENAME='MILLER';


SELECT /*+ HASH_JOIN(D) */
E.empno, E.ename, D.dname
FROM    DEPT D JOIN EMP E
on D.deptno = E.deptno;




SELECT * 
FROM SALGRADE;

SELECT ENAME, SAL, GRADE
FROM EMP, SALGRADE 
WHERE SAL BETWEEN LOSAL AND HISAL;

SELECT CONCAT(employee.ename, ' 의 매니저는 ', manager.ename)
FROM EMP employee, EMP manager
WHERE employee.mgr = manager.empno;

SELECT * 
FROM EMP CROSS JOIN DEPT;

SELECT ENAME, DNAME 
FROM EMP INNER JOIN DEPT
ON EMP.DEPTNO=DEPT.DEPTNO
WHERE ENAME='MILLER';

SELECT EMP.ENAME, DEPT.DNAME 
FROM EMP INNER JOIN DEPT
USING (DEPTNO);

SELECT EMP.ENAME, DEPT.DNAME 
FROM EMP NATURAL JOIN DEPT;

CREATE TABLE DEPT01( 
DEPTNO INT(2), 
DNAME VARCHAR(14)); 

INSERT INTO DEPT01 VALUES(10, 'ACCOUNTING');
INSERT INTO DEPT01 VALUES (20, 'RESEARCH'); 

SELECT * 
FROM DEPT01;


CREATE TABLE DEPT02( 
DEPTNO INT(2), 
DNAME VARCHAR(14)); 

INSERT INTO DEPT02 VALUES(10, 'ACCOUNTING');
INSERT INTO DEPT02 VALUES (30, 'SALES'); 

SELECT * FROM DEPT02;

SELECT *
FROM DEPT01 LEFT OUTER JOIN DEPT02
ON DEPT01.DEPTNO = DEPT02.DEPTNO;

SELECT *
FROM DEPT01 RIGHT OUTER JOIN DEPT02
USING(DEPTNO);

SELECT *
FROM DEPT01 FULL OUTER JOIN DEPT02
USING(DEPTNO);

SELECT *
FROM DEPT01 LEFT OUTER JOIN DEPT02
ON DEPT01.DEPTNO = DEPT02.DEPTNO
UNION
SELECT *
FROM DEPT01 RIGHT OUTER JOIN DEPT02
ON DEPT01.DEPTNO = DEPT02.DEPTNO

SELECT * FROM TCAR C
INNER JOIN TMAKER M ON C.maker = M.maker 
INNER JOIN tCity T ON M.factory = T.name;

SELECT C.car, M.factory, T.area 
FROM TCAR C INNER JOIN TMAKER M ON C.maker = M.maker INNER JOIN tCity T ON M.factory = T.name;

SELECT * FROM TMAKER M
LEFT OUTER JOIN tCity T ON M.factory = T.name LEFT OUTER JOIN TCAR C ON M.maker = C.maker;